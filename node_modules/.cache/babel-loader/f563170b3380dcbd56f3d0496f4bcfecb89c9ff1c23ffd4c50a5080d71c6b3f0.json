{"ast":null,"code":"import _objectSpread from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import Chart from\"react-apexcharts\";import{Popover}from\"../../popup/Popover\";import\"../Chart.css\";import\"./BarChartPopup.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var BarChart=function BarChart(_ref){var data=_ref.data,xAxis=_ref.xAxis,title=_ref.title,name=_ref.name,width=_ref.width,eachBarClicked=_ref.eachBarClicked,barChartPopoverdata=_ref.barChartPopoverdata,subTitle=_ref.subTitle;var _useState=useState([{name:title,//will be displayed on the y-axis\ndata:data}]),_useState2=_slicedToArray(_useState,2),dataSeries=_useState2[0],setdataSeries=_useState2[1];var _useState3=useState({title:title,subTitle:title}),_useState4=_slicedToArray(_useState3,2),subTitles=_useState4[0],setsubTitles=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),popupPosition=_useState6[0],setPopupPosition=_useState6[1];var barRef=useRef(null);var _useState7=useState(barChartPopoverdata),_useState8=_slicedToArray(_useState7,2),popupData=_useState8[0],setPopupData=_useState8[1];var _useState9=useState({legend:{show:false},chart:{events:{dataPointSelection:function dataPointSelection(event,chartContext,config){var dataPointIndex=config.dataPointIndex;var selectedXValue=option.xaxis.categories[dataPointIndex];eachBarClick(selectedXValue,event);}}},xaxis:{categories:xAxis},title:{text:title,style:{fontSize:\"14px\",fontWeight:\"bold\",fontFamily:\"Bukra\",color:\"black\"}},plotOptions:{bar:{columnWidth:50,colors:{ranges:[{from:-100,to:0,color:\"#b70849\"},{from:0,to:100,color:\"#1034a6\"}]}}},// dataLabels: {\n//   enabled: true,\n//   formatter: function (val, opts) {\n//     const isPositive = val >= 0;\n//     return isPositive && type == \"progress\" ? `+${val}` : val.toString();\n//   },\n// },\nyaxis:{forceNiceScale:true,labels:{formatter:function formatter(val){return Math.round(val);}}}}),_useState10=_slicedToArray(_useState9,2),option=_useState10[0],setOption=_useState10[1];useEffect(function(){setPopupData(barChartPopoverdata);setsubTitles(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{subTitle:title});});if(data){setdataSeries([{name:name,data:data}]);}},[data]);useEffect(function(){setsubTitles(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{subTitle:title});});},[]);useEffect(function(){//setdataSeries(data);\n//if (data) {\n//const categories = data.map((item) => item);\n//setsubTitles(subTitle);\nsetsubTitles(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{subTitle:title});});setPopupData(barChartPopoverdata);if(data){setdataSeries([{name:name,data:data}]);}setOption(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{title:{text:title},xaxis:{categories:xAxis},chart:{events:{dataPointSelection:handleDataPointSelection}}});});var handleDataPointSelection=function handleDataPointSelection(event,chartContext,config){var dataPointIndex=config.dataPointIndex;var selectedXValue=xAxis[dataPointIndex];eachBarClick(selectedXValue,event);};// setOption((prevOption) => ({\n//   ...prevOption,\n//   chart: {\n//     events: {\n//       dataPointSelection: handleDataPointSelection,\n//     },\n//   },\n// }));\n},[xAxis]);var xLabelToIndexMap={};option.xaxis.categories.forEach(function(label,index){xLabelToIndexMap[label]=index;});var eachBarClick=function eachBarClick(value,event){var barPosition={x:event.clientX-125,y:200//event.clientY,\n};eachBarClicked(value,title);setPopupPosition(barPosition);};//this is to add class name to x-xis label\nvar wrapXAxisLabels=function wrapXAxisLabels(chartContext,_ref2){var axis=_ref2.axis,tick=_ref2.tick,text=_ref2.text;if(axis===\"xaxis\"){tick.classList.add(\"apexchart-xaxis-label\");}};var handleClosePopover=function handleClosePopover(){setPopupData(null);// Clear the popover data to close it\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"bar-chart\",children:[/*#__PURE__*/_jsx(Chart,{options:option,series:dataSeries,type:\"bar\",height:350,width:width?550:\"100%\",events:{dataPointSelection:wrapXAxisLabels// Apply the class to x-axis labels\n}}),barChartPopoverdata&&/*#__PURE__*/_jsx(Popover,{tablePopupData:barChartPopoverdata,popoverPosition:popupPosition,onClose:handleClosePopover})]});};","map":{"version":3,"names":["React","useEffect","useRef","useState","Chart","Popover","BarChart","data","xAxis","title","name","width","eachBarClicked","barChartPopoverdata","subTitle","dataSeries","setdataSeries","subTitles","setsubTitles","popupPosition","setPopupPosition","barRef","popupData","setPopupData","legend","show","chart","events","dataPointSelection","event","chartContext","config","dataPointIndex","selectedXValue","option","xaxis","categories","eachBarClick","text","style","fontSize","fontWeight","fontFamily","color","plotOptions","bar","columnWidth","colors","ranges","from","to","yaxis","forceNiceScale","labels","formatter","val","Math","round","setOption","prevState","handleDataPointSelection","xLabelToIndexMap","forEach","label","index","value","barPosition","x","clientX","y","wrapXAxisLabels","axis","tick","classList","add","handleClosePopover"],"sources":["/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/src/components/Graph/barChart/BarChart.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Chart from \"react-apexcharts\";\nimport { getHttp } from \"../../../service/APIRequest\";\nimport { Popover } from \"../../popup/Popover\";\nimport \"../Chart.css\";\nimport \"./BarChartPopup.css\";\n\ninterface BarChartInterface {\n  data;\n  xAxis;\n  title?;\n  name?;\n  width?: any;\n  eachBarClicked?: any;\n  barChartPopoverdata?: any;\n  subTitle?: any;\n}\n\nexport const BarChart: React.FC<BarChartInterface> = ({\n  data,\n  xAxis,\n  title,\n  name,\n  width,\n  eachBarClicked,\n  barChartPopoverdata,\n  subTitle,\n}) => {\n  const [dataSeries, setdataSeries] = useState<any>([\n    {\n      name: title, //will be displayed on the y-axis\n      data: data,\n    },\n  ]);\n\n  const [subTitles, setsubTitles] = useState<any>({\n    title: title,\n    subTitle: title,\n  });\n  const [popupPosition, setPopupPosition] = useState(null);\n  const barRef = useRef(null);\n  const [popupData, setPopupData] = useState(barChartPopoverdata);\n  const [option, setOption] = useState<any>({\n    legend: {\n      show: false,\n    },\n    chart: {\n      events: {\n        dataPointSelection: function (event, chartContext, config) {\n          const dataPointIndex = config.dataPointIndex;\n          const selectedXValue = option.xaxis.categories[dataPointIndex];\n          eachBarClick(selectedXValue, event);\n        },\n      },\n    },\n    xaxis: {\n      categories: xAxis,\n    },\n    title: {\n      text: title,\n      style: {\n        fontSize: \"14px\",\n        fontWeight: \"bold\",\n        fontFamily: \"Bukra\",\n        color: \"black\",\n      },\n    },\n    plotOptions: {\n      bar: {\n        columnWidth: 50,\n        colors: {\n          ranges: [\n            {\n              from: -100,\n              to: 0,\n              color: \"#b70849\",\n            },\n            {\n              from: 0,\n              to: 100,\n              color: \"#1034a6\",\n            },\n          ],\n        },\n      },\n    },\n    // dataLabels: {\n    //   enabled: true,\n    //   formatter: function (val, opts) {\n    //     const isPositive = val >= 0;\n    //     return isPositive && type == \"progress\" ? `+${val}` : val.toString();\n    //   },\n    // },\n    yaxis: {\n      forceNiceScale: true,\n      labels: {\n        formatter: function (val) {\n          return Math.round(val);\n        },\n      },\n    },\n  });\n\n  useEffect(() => {\n    setPopupData(barChartPopoverdata);\n    setsubTitles((prevState) => ({ ...prevState, subTitle: title }));\n    if (data) {\n      setdataSeries([\n        {\n          name: name,\n          data: data,\n        },\n      ]);\n    }\n  }, [data]);\n\n  useEffect(() => {\n    setsubTitles((prevState) => ({ ...prevState, subTitle: title }));\n  }, []);\n\n  useEffect(() => {\n    //setdataSeries(data);\n    //if (data) {\n    //const categories = data.map((item) => item);\n    //setsubTitles(subTitle);\n    setsubTitles((prevState) => ({ ...prevState, subTitle: title }));\n    setPopupData(barChartPopoverdata);\n    if (data) {\n      setdataSeries([\n        {\n          name: name,\n          data: data,\n        },\n      ]);\n    }\n    setOption((prevState) => ({\n      ...prevState,\n      title: {\n        text: title,\n      },\n      xaxis: {\n        categories: xAxis,\n      },\n      chart: {\n        events: {\n          dataPointSelection: handleDataPointSelection,\n        },\n      },\n    }));\n\n    const handleDataPointSelection = (event, chartContext, config) => {\n      const dataPointIndex = config.dataPointIndex;\n      const selectedXValue = xAxis[dataPointIndex];\n      eachBarClick(selectedXValue, event);\n    };\n\n    // setOption((prevOption) => ({\n    //   ...prevOption,\n    //   chart: {\n    //     events: {\n    //       dataPointSelection: handleDataPointSelection,\n    //     },\n    //   },\n    // }));\n  }, [xAxis]);\n\n  const xLabelToIndexMap = {};\n  option.xaxis.categories.forEach((label, index) => {\n    xLabelToIndexMap[label] = index;\n  });\n\n  const eachBarClick = (value, event) => {\n    const barPosition = {\n      x: event.clientX - 125,\n      y: 200, //event.clientY,\n    };\n    eachBarClicked(value, title);\n    setPopupPosition(barPosition);\n  };\n\n  //this is to add class name to x-xis label\n  const wrapXAxisLabels = (chartContext, { axis, tick, text }) => {\n    if (axis === \"xaxis\") {\n      tick.classList.add(\"apexchart-xaxis-label\");\n    }\n  };\n\n  const handleClosePopover = () => {\n    setPopupData(null); // Clear the popover data to close it\n  };\n\n  return (\n    <div className=\"bar-chart\">\n      {/* onClick={() => setPopupData(null)} */}\n      <Chart\n        options={option}\n        series={dataSeries}\n        type=\"bar\"\n        height={350}\n        width={width ? 550 : \"100%\"}\n        events={{\n          dataPointSelection: wrapXAxisLabels, // Apply the class to x-axis labels\n        }}\n      />\n      {barChartPopoverdata && (\n        <Popover\n          tablePopupData={barChartPopoverdata}\n          popoverPosition={popupPosition}\n          onClose={handleClosePopover}\n        />\n      )}\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _regeneratorRuntime from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import\"./Login.css\";import{getHttp,postHttp}from\"../../service/APIRequest\";import{useHistory}from\"react-router-dom\";import{userTypes}from\"../../service/Constants\";import ErrorComponent from\"../../components/errorComponent/ErrorComponent\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"admin\"),_useState6=_slicedToArray(_useState5,2),userType=_useState6[0],setUserType=_useState6[1];// Default value\nvar _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),selectedEntity=_useState8[0],setSelectedEntity=_useState8[1];// Default value\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),entityList=_useState10[0],setEntityList=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),errorMessage=_useState12[0],setErrorMessage=_useState12[1];var _useState13=useState(\"main_admin\"),_useState14=_slicedToArray(_useState13,2),adminType=_useState14[0],setAdminType=_useState14[1];useEffect(function(){// getEntityList();\n},[]);console.log(userTypes);var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(!username||!password)){_context.next=3;break;}// Display an error message for empty fields\nsetErrorMessage(\"Username and password are required.\");return _context.abrupt(\"return\");case 3:if(!(userType===\"admin\"&&!adminType)){_context.next=6;break;}// Display an error message for admin type dropdown\nsetErrorMessage(\"Please select an admin type.\");return _context.abrupt(\"return\");case 6:if(!(userType===\"user\"&&!selectedEntity)){_context.next=9;break;}// Display an error message for entity dropdown\nsetErrorMessage(\"Please select an entity.\");return _context.abrupt(\"return\");case 9:// Reset error message if there are no validation errors\nsetErrorMessage(\"\");_context.prev=10;_context.next=13;return postHttp(\"auth/user/login\",{username:username,password:password,userType:userType==\"admin\"?adminType:userType,entity:selectedEntity});case 13:response=_context.sent;//console.log(response);\n//if (response.status == 200) {\n// Store token in session storage\n// Redirect to a protected page\nif(response){sessionStorage.setItem(\"userDetails\",JSON.stringify(response));sessionStorage.setItem(\"loginStatus\",\"true\");history.push(\"/\",response);}// }\n_context.next=21;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](10);console.error(\"Login failed\",_context.t0);setErrorMessage(_context.t0);case 21:case\"end\":return _context.stop();}},_callee,null,[[10,17]]);}));return function handleLogin(){return _ref.apply(this,arguments);};}();var handleUserTypeChange=function handleUserTypeChange(event){setUserType(event.target.value);if(event.target.value==\"user\"){getEntityList();}};var handleEntityChange=function handleEntityChange(event){setSelectedEntity(event.target.value);//console.log(selectedValue);\n//setSelectedEntity(selectedValue.label);\n};var getEntityList=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getHttp(\"entity/getNameDetails\");case 2:response=_context2.sent;_context2.next=5;return setEntityList(response);case 5:case\"end\":return _context2.stop();}},_callee2);}));return function getEntityList(){return _ref2.apply(this,arguments);};}();var handleAdminTypeChange=function handleAdminTypeChange(event){setAdminType(event.target.value);//setSelectedEntity(selectedValue.label);\n};return/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",value:username,onChange:function onChange(e){return setUsername(e.target.value);},className:\"button\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},className:\"button\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"User Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:userType,onChange:handleUserTypeChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:\"User\"})]})]}),userType===\"admin\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"Admin Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:adminType,onChange:handleAdminTypeChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"main_admin\",children:\"Main Admin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"desc_admin\",children:\"Desc Admin\"})]})]}),userType===\"user\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"Entity\"}),/*#__PURE__*/_jsx(\"select\",{value:selectedEntity,onChange:handleEntityChange,children:entityList===null||entityList===void 0?void 0:entityList.map(function(item,index){return/*#__PURE__*/_jsx(\"option\",{value:item.name,children:item.label},index);})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"login-button\",onClick:handleLogin,children:\"Login\"}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:errorMessage}),/*#__PURE__*/_jsx(ErrorComponent,{})]})})// <UserLogin />\n;}export default Login;","map":{"version":3,"names":["React","useEffect","useState","getHttp","postHttp","useHistory","userTypes","ErrorComponent","Login","history","username","setUsername","password","setPassword","userType","setUserType","selectedEntity","setSelectedEntity","entityList","setEntityList","errorMessage","setErrorMessage","adminType","setAdminType","console","log","handleLogin","entity","response","sessionStorage","setItem","JSON","stringify","push","error","handleUserTypeChange","event","target","value","getEntityList","handleEntityChange","handleAdminTypeChange","e","map","item","index","name","label"],"sources":["/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/src/pages/login/Login.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\n\nimport \"./Login.css\";\nimport { getHttp, postHttp } from \"../../service/APIRequest\";\nimport { useHistory } from \"react-router-dom\";\nimport UserLogin from \"./UserLogin\";\nimport DropDown from \"../../components/dropDown/DropDown\";\nimport { adminTypes, userTypes } from \"../../service/Constants\";\nimport ErrorComponent from \"../../components/errorComponent/ErrorComponent\";\n\nfunction Login() {\n  const history = useHistory();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [userType, setUserType] = useState(\"admin\"); // Default value\n  const [selectedEntity, setSelectedEntity] = useState(\"\"); // Default value\n  const [entityList, setEntityList] = useState<any>();\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [adminType, setAdminType] = useState(\"main_admin\");\n\n  useEffect(() => {\n    // getEntityList();\n  }, []);\n\n  console.log(userTypes);\n  const handleLogin = async () => {\n    if (!username || !password) {\n      // Display an error message for empty fields\n      setErrorMessage(\"Username and password are required.\");\n      return;\n    }\n\n    if (userType === \"admin\" && !adminType) {\n      // Display an error message for admin type dropdown\n      setErrorMessage(\"Please select an admin type.\");\n      return;\n    }\n\n    if (userType === \"user\" && !selectedEntity) {\n      // Display an error message for entity dropdown\n      setErrorMessage(\"Please select an entity.\");\n      return;\n    }\n\n    // Reset error message if there are no validation errors\n    setErrorMessage(\"\");\n    try {\n      const response = await postHttp(\"auth/user/login\", {\n        username,\n        password,\n        userType: userType == \"admin\" ? adminType : userType,\n        entity: selectedEntity,\n      });\n      //console.log(response);\n      //if (response.status == 200) {\n      // Store token in session storage\n\n      // Redirect to a protected page\n      if (response) {\n        sessionStorage.setItem(\"userDetails\", JSON.stringify(response));\n        sessionStorage.setItem(\"loginStatus\", \"true\");\n        history.push(\"/\", response);\n      }\n      // }\n    } catch (error) {\n      console.error(\"Login failed\", error);\n      setErrorMessage(error);\n    }\n  };\n\n  const handleUserTypeChange = (event) => {\n    setUserType(event.target.value);\n    if (event.target.value == \"user\") {\n      getEntityList();\n    }\n  };\n\n  const handleEntityChange = (event) => {\n    setSelectedEntity(event.target.value);\n    //console.log(selectedValue);\n    //setSelectedEntity(selectedValue.label);\n  };\n\n  const getEntityList = async () => {\n    const response = await getHttp(\"entity/getNameDetails\"); //\n    await setEntityList(response);\n  };\n\n  const handleAdminTypeChange = (event) => {\n    setAdminType(event.target.value);\n    //setSelectedEntity(selectedValue.label);\n  };\n\n  return (\n    <div className=\"login-container\">\n      <div className=\"login-form\">\n        <div className=\"display-flex\">\n          <div className=\"align-center\">Username</div>\n          <input\n            type=\"text\"\n            placeholder=\"Username\"\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n            className=\"button\"\n          />\n        </div>\n        <div className=\"display-flex\">\n          <div className=\"align-center\">Password</div>\n          <input\n            type=\"password\"\n            placeholder=\"Password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            className=\"button\"\n          />\n        </div>\n\n        <div className=\"display-flex\">\n          <div className=\"align-center\">User Type</div>\n\n          {/* <DropDown\n            mainList={userTypes}\n            //name=\"Filter\"\n            onChangeDropDownItem={handleUserTypeChange}\n            isMulti={false}\n            classname=\"margin\"\n          /> */}\n          <select value={userType} onChange={handleUserTypeChange}>\n            <option value=\"admin\">Admin</option>\n            <option value=\"user\">User</option>\n          </select>\n        </div>\n        {userType === \"admin\" && (\n          <div className=\"display-flex\">\n            <div className=\"align-center\">Admin Type</div>\n            <select value={adminType} onChange={handleAdminTypeChange}>\n              <option value=\"main_admin\">Main Admin</option>\n              <option value=\"desc_admin\">Desc Admin</option>\n            </select>\n\n            {/* <DropDown\n              mainList={adminTypes}\n              //name=\"Filter\"\n              onChangeDropDownItem={handleEntityChange}\n              isMulti={false}\n            /> */}\n          </div>\n        )}\n\n        {userType === \"user\" && (\n          <div className=\"display-flex\">\n            <div className=\"align-center\">Entity</div>\n            <select value={selectedEntity} onChange={handleEntityChange}>\n              {entityList?.map((item, index) => (\n                <option key={index} value={item.name}>\n                  {item.label}\n                </option>\n              ))}\n            </select>\n            {/* <DropDown\n              mainList={entityList}\n              //name=\"Filter\"\n              onChangeDropDownItem={handleEntityChange}\n              isMulti={false}\n            /> */}\n          </div>\n        )}\n\n        <button className=\"login-button\" onClick={handleLogin}>\n          Login\n        </button>\n        {errorMessage && <div className=\"error-message\">{errorMessage}</div>}\n        <ErrorComponent />\n      </div>\n    </div>\n    // <UserLogin />\n  );\n}\n\nexport default Login;\n"],"mappings":"2dAAA,MAAOA,MAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAGlD,MAAO,aAAa,CACpB,OAASC,OAAO,CAAEC,QAAQ,KAAQ,0BAA0B,CAC5D,OAASC,UAAU,KAAQ,kBAAkB,CAG7C,OAAqBC,SAAS,KAAQ,yBAAyB,CAC/D,MAAOC,eAAc,KAAM,gDAAgD,CAAC,wFAE5E,QAASC,MAAK,EAAG,CACf,GAAMC,QAAO,CAAGJ,UAAU,EAAE,CAC5B,cAAgCH,QAAQ,CAAC,EAAE,CAAC,wCAArCQ,QAAQ,eAAEC,WAAW,eAC5B,eAAgCT,QAAQ,CAAC,EAAE,CAAC,yCAArCU,QAAQ,eAAEC,WAAW,eAC5B,eAAgCX,QAAQ,CAAC,OAAO,CAAC,yCAA1CY,QAAQ,eAAEC,WAAW,eAAuB;AACnD,eAA4Cb,QAAQ,CAAC,EAAE,CAAC,yCAAjDc,cAAc,eAAEC,iBAAiB,eAAkB;AAC1D,eAAoCf,QAAQ,EAAO,0CAA5CgB,UAAU,gBAAEC,aAAa,gBAChC,gBAAwCjB,QAAQ,CAAC,EAAE,CAAC,2CAA7CkB,YAAY,gBAAEC,eAAe,gBACpC,gBAAkCnB,QAAQ,CAAC,YAAY,CAAC,2CAAjDoB,SAAS,gBAAEC,YAAY,gBAE9BtB,SAAS,CAAC,UAAM,CACd;AAAA,CACD,CAAE,EAAE,CAAC,CAENuB,OAAO,CAACC,GAAG,CAACnB,SAAS,CAAC,CACtB,GAAMoB,YAAW,4FAAG,sJACd,CAAChB,QAAQ,EAAI,CAACE,QAAQ,0BACxB;AACAS,eAAe,CAAC,qCAAqC,CAAC,CAAC,6CAIrDP,QAAQ,GAAK,OAAO,EAAI,CAACQ,SAAS,0BACpC;AACAD,eAAe,CAAC,8BAA8B,CAAC,CAAC,6CAI9CP,QAAQ,GAAK,MAAM,EAAI,CAACE,cAAc,0BACxC;AACAK,eAAe,CAAC,0BAA0B,CAAC,CAAC,wCAI9C;AACAA,eAAe,CAAC,EAAE,CAAC,CAAC,wCAEKjB,SAAQ,CAAC,iBAAiB,CAAE,CACjDM,QAAQ,CAARA,QAAQ,CACRE,QAAQ,CAARA,QAAQ,CACRE,QAAQ,CAAEA,QAAQ,EAAI,OAAO,CAAGQ,SAAS,CAAGR,QAAQ,CACpDa,MAAM,CAAEX,cACV,CAAC,CAAC,SALIY,QAAQ,eAMd;AACA;AACA;AAEA;AACA,GAAIA,QAAQ,CAAE,CACZC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAEC,IAAI,CAACC,SAAS,CAACJ,QAAQ,CAAC,CAAC,CAC/DC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAE,MAAM,CAAC,CAC7CrB,OAAO,CAACwB,IAAI,CAAC,GAAG,CAAEL,QAAQ,CAAC,CAC7B,CACA;AAAA,kFAEAJ,OAAO,CAACU,KAAK,CAAC,cAAc,aAAQ,CACpCb,eAAe,aAAO,CAAC,qEAE1B,kBA3CKK,YAAW,0CA2ChB,CAED,GAAMS,qBAAoB,CAAG,QAAvBA,qBAAoB,CAAIC,KAAK,CAAK,CACtCrB,WAAW,CAACqB,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAC/B,GAAIF,KAAK,CAACC,MAAM,CAACC,KAAK,EAAI,MAAM,CAAE,CAChCC,aAAa,EAAE,CACjB,CACF,CAAC,CAED,GAAMC,mBAAkB,CAAG,QAArBA,mBAAkB,CAAIJ,KAAK,CAAK,CACpCnB,iBAAiB,CAACmB,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CACrC;AACA;AACF,CAAC,CAED,GAAMC,cAAa,6FAAG,6KACGpC,QAAO,CAAC,uBAAuB,CAAC,QAAjDyB,QAAQ,uCACRT,cAAa,CAACS,QAAQ,CAAC,wDAC9B,kBAHKW,cAAa,2CAGlB,CAED,GAAME,sBAAqB,CAAG,QAAxBA,sBAAqB,CAAIL,KAAK,CAAK,CACvCb,YAAY,CAACa,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAChC;AACF,CAAC,CAED,mBACE,YAAK,SAAS,CAAC,iBAAiB,uBAC9B,aAAK,SAAS,CAAC,YAAY,wBACzB,aAAK,SAAS,CAAC,cAAc,wBAC3B,YAAK,SAAS,CAAC,cAAc,UAAC,UAAQ,EAAM,cAC5C,cACE,IAAI,CAAC,MAAM,CACX,WAAW,CAAC,UAAU,CACtB,KAAK,CAAE5B,QAAS,CAChB,QAAQ,CAAE,kBAACgC,CAAC,QAAK/B,YAAW,CAAC+B,CAAC,CAACL,MAAM,CAACC,KAAK,CAAC,EAAC,CAC7C,SAAS,CAAC,QAAQ,EAClB,GACE,cACN,aAAK,SAAS,CAAC,cAAc,wBAC3B,YAAK,SAAS,CAAC,cAAc,UAAC,UAAQ,EAAM,cAC5C,cACE,IAAI,CAAC,UAAU,CACf,WAAW,CAAC,UAAU,CACtB,KAAK,CAAE1B,QAAS,CAChB,QAAQ,CAAE,kBAAC8B,CAAC,QAAK7B,YAAW,CAAC6B,CAAC,CAACL,MAAM,CAACC,KAAK,CAAC,EAAC,CAC7C,SAAS,CAAC,QAAQ,EAClB,GACE,cAEN,aAAK,SAAS,CAAC,cAAc,wBAC3B,YAAK,SAAS,CAAC,cAAc,UAAC,WAAS,EAAM,cAS7C,gBAAQ,KAAK,CAAExB,QAAS,CAAC,QAAQ,CAAEqB,oBAAqB,wBACtD,eAAQ,KAAK,CAAC,OAAO,UAAC,OAAK,EAAS,cACpC,eAAQ,KAAK,CAAC,MAAM,UAAC,MAAI,EAAS,GAC3B,GACL,CACLrB,QAAQ,GAAK,OAAO,eACnB,aAAK,SAAS,CAAC,cAAc,wBAC3B,YAAK,SAAS,CAAC,cAAc,UAAC,YAAU,EAAM,cAC9C,gBAAQ,KAAK,CAAEQ,SAAU,CAAC,QAAQ,CAAEmB,qBAAsB,wBACxD,eAAQ,KAAK,CAAC,YAAY,UAAC,YAAU,EAAS,cAC9C,eAAQ,KAAK,CAAC,YAAY,UAAC,YAAU,EAAS,GACvC,GASZ,CAEA3B,QAAQ,GAAK,MAAM,eAClB,aAAK,SAAS,CAAC,cAAc,wBAC3B,YAAK,SAAS,CAAC,cAAc,UAAC,QAAM,EAAM,cAC1C,eAAQ,KAAK,CAAEE,cAAe,CAAC,QAAQ,CAAEwB,kBAAmB,UACzDtB,UAAU,SAAVA,UAAU,iBAAVA,UAAU,CAAEyB,GAAG,CAAC,SAACC,IAAI,CAAEC,KAAK,qBAC3B,eAAoB,KAAK,CAAED,IAAI,CAACE,IAAK,UAClCF,IAAI,CAACG,KAAK,EADAF,KAAK,CAET,EACV,CAAC,EACK,GAQZ,cAED,eAAQ,SAAS,CAAC,cAAc,CAAC,OAAO,CAAEnB,WAAY,UAAC,OAEvD,EAAS,CACRN,YAAY,eAAI,YAAK,SAAS,CAAC,eAAe,UAAEA,YAAY,EAAO,cACpE,KAAC,cAAc,IAAG,GACd,EAER;AAAA,CAEJ,CAEA,cAAeZ,MAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}
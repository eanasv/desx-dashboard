{"ast":null,"code":"import _regeneratorRuntime from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{DownloadExcel}from\"../../components/downloadExcel/DownloadExcel\";import ErrorComponent from\"../../components/errorComponent/ErrorComponent\";import DropDown from\"../../components/dropDown/DropDown\";import{SubHeader}from\"../../components/subHeader/SubHeader\";import{postHttp}from\"../../service/APIRequest\";import{excelUpload}from\"../../service/Config\";import\"./FileUpload.css\";import Store from\"../../redux/Store\";import{showErrorMesaage}from\"../../redux/features/errorSlice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FileUpload=function FileUpload(){// const [file, setFile] = useState(null);\n// const [selectedFile, setSelectedFile] = useState(null);\n// const [selectedFileType, setSelectedFileType] = useState(\"\");\n// const handleItemSelect = (event) => {\n//   console.log(event);\n//   setSelectedFile(event.target.files[0]);\n//   setSelectedFileType(event.target.value);\n// };\n// const handleFileChange = (e) => {\n//   setFile(e.target.files[0]);\n// };\n// const handleResponseText = () => {\n//   setresponseText(null);\n// };\nvar typeOfDropdown=[{id:1,label:\"Employee\",value:\"Employee\"},{id:2,label:\"Training\",value:\"Training\"}// { id: 3, label: \"Entity\", value: \"Entity\" },\n];var _useState=useState(null),_useState2=_slicedToArray(_useState,2),responseText=_useState2[0],setresponseText=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedFile=_useState4[0],setSelectedFile=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),selectedOption=_useState6[0],setSelectedOption=_useState6[1];var userDeatilsString=sessionStorage.getItem(\"userDetails\");var userDetailsObj=JSON.parse(userDeatilsString);//\nvar handleFileChange=function handleFileChange(event){setSelectedFile(event.target.files[0]);};var handleOptionChange=function handleOptionChange(event){setSelectedOption(event);};// const resetResponseText = () => {\n//   setTimeout(() => {\n//     setresponseText(\"\");\n//   }, 10000);\n// };\nvar handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var entityName,endpoint,formData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:entityName=userDetailsObj.entity;if(entityName){endpoint+=\"?entityName=\".concat(entityName);}if(selectedOption){_context.next=7;break;}Store.dispatch(showErrorMesaage(\"Please select an option from the dropdown\"));return _context.abrupt(\"return\");case 7:if(selectedFile){_context.next=10;break;}Store.dispatch(showErrorMesaage(\"Please select one file to upload\"));return _context.abrupt(\"return\");case 10:if(selectedOption.value==\"Employee\"){endpoint=excelUpload+\"upload\";}else if(selectedOption.value==\"Training\"){endpoint=excelUpload+\"trainingNeedsUpload\";}formData=new FormData();formData.append(\"file\",selectedFile);formData.append(\"option\",selectedOption.value);setresponseText(\"\");postHttp(endpoint,formData).then(function(response){// console.log(response);\nif(response){// setresponseText(response?.message);\nStore.dispatch(showErrorMesaage(response.data));}setSelectedFile(null);setSelectedOption(null);clearFileInput();}).catch(function(error){console.log(error);Store.dispatch(showErrorMesaage(error===null||error===void 0?void 0:error.error));//setresponseText(error);\nclearFileInput();// handle error\n});case 16:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(){return _ref.apply(this,arguments);};}();var clearFileInput=function clearFileInput(){//resetResponseText();\nvar inputElement=document.getElementById(\"file\");if(inputElement){inputElement.value=\"\";// Clear the input value\n}};var userDeatils=JSON.parse(sessionStorage.getItem(\"userDetails\"));return/*#__PURE__*/_jsxs(\"div\",{className:\"upload-container \",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(SubHeader,{pageHeadding:\"File Upload \".concat(userDeatils.entity),showBreadcrumbs:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-area\",children:[/*#__PURE__*/_jsx(DropDown,{mainList:typeOfDropdown,name:\"\",onChangeDropDownItem:handleOptionChange,isMulti:false,classname:\"flex\",placeholder:\"Select an option\",value:selectedOption}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-browser\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file\",children:\"Select a file:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"file\",onChange:handleFileChange,accept:\".xls, .xlsx\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-button std unwanted text upload-button\",onClick:handleSubmit,children:\"Upload\"})]}),/*#__PURE__*/_jsx(ErrorComponent,{})]}),/*#__PURE__*/_jsx(DownloadExcel,{})]});};export default FileUpload;","map":{"version":3,"names":["React","useState","DownloadExcel","ErrorComponent","DropDown","SubHeader","postHttp","excelUpload","Store","showErrorMesaage","FileUpload","typeOfDropdown","id","label","value","responseText","setresponseText","selectedFile","setSelectedFile","selectedOption","setSelectedOption","userDeatilsString","sessionStorage","getItem","userDetailsObj","JSON","parse","handleFileChange","event","target","files","handleOptionChange","handleSubmit","entityName","entity","endpoint","dispatch","formData","FormData","append","then","response","data","clearFileInput","catch","error","console","log","inputElement","document","getElementById","userDeatils"],"sources":["/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/src/pages/dataFileUpload/FileUpload.tsx"],"sourcesContent":["import axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { DownloadExcel } from \"../../components/downloadExcel/DownloadExcel\";\nimport ErrorComponent from \"../../components/errorComponent/ErrorComponent\";\nimport DropDown from \"../../components/dropDown/DropDown\";\nimport { SubHeader } from \"../../components/subHeader/SubHeader\";\nimport { postHttp } from \"../../service/APIRequest\";\nimport { excelUpload } from \"../../service/Config\";\nimport \"./FileUpload.css\";\nimport Store from \"../../redux/Store\";\nimport { showErrorMesaage } from \"../../redux/features/errorSlice\";\n\nconst FileUpload = () => {\n  // const [file, setFile] = useState(null);\n  // const [selectedFile, setSelectedFile] = useState(null);\n  // const [selectedFileType, setSelectedFileType] = useState(\"\");\n\n  // const handleItemSelect = (event) => {\n  //   console.log(event);\n  //   setSelectedFile(event.target.files[0]);\n  //   setSelectedFileType(event.target.value);\n  // };\n\n  // const handleFileChange = (e) => {\n  //   setFile(e.target.files[0]);\n  // };\n\n  // const handleResponseText = () => {\n  //   setresponseText(null);\n  // };\n\n  var typeOfDropdown = [\n    { id: 1, label: \"Employee\", value: \"Employee\" },\n    { id: 2, label: \"Training\", value: \"Training\" },\n    // { id: 3, label: \"Entity\", value: \"Entity\" },\n  ];\n  const [responseText, setresponseText] = useState(null);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [selectedOption, setSelectedOption] = useState(null);\n\n  var userDeatilsString = sessionStorage.getItem(\"userDetails\");\n  var userDetailsObj = JSON.parse(userDeatilsString); //\n\n  const handleFileChange = (event) => {\n    setSelectedFile(event.target.files[0]);\n  };\n\n  const handleOptionChange = (event) => {\n    setSelectedOption(event);\n  };\n\n  // const resetResponseText = () => {\n  //   setTimeout(() => {\n  //     setresponseText(\"\");\n  //   }, 10000);\n  // };\n\n  const handleSubmit = async () => {\n    const entityName = userDetailsObj.entity;\n    let endpoint;\n\n    if (entityName) {\n      endpoint += `?entityName=${entityName}`;\n    }\n    if (!selectedOption) {\n      Store.dispatch(\n        showErrorMesaage(\"Please select an option from the dropdown\")\n      );\n      return;\n    } else if (!selectedFile) {\n      Store.dispatch(showErrorMesaage(\"Please select one file to upload\"));\n      return;\n    }\n    if (selectedOption.value == \"Employee\") {\n      endpoint = excelUpload + \"upload\";\n    } else if (selectedOption.value == \"Training\") {\n      endpoint = excelUpload + \"trainingNeedsUpload\";\n    }\n\n    const formData = new FormData();\n    formData.append(\"file\", selectedFile);\n    formData.append(\"option\", selectedOption.value);\n    setresponseText(\"\");\n    postHttp(endpoint, formData)\n      .then((response) => {\n        // console.log(response);\n        if (response) {\n          // setresponseText(response?.message);\n          Store.dispatch(showErrorMesaage(response.data));\n        }\n        setSelectedFile(null);\n        setSelectedOption(null);\n        clearFileInput();\n      })\n      .catch((error) => {\n        console.log(error);\n        Store.dispatch(showErrorMesaage(error?.error));\n        //setresponseText(error);\n        clearFileInput();\n        // handle error\n      });\n  };\n\n  const clearFileInput = () => {\n    //resetResponseText();\n    const inputElement = document.getElementById(\"file\") as HTMLInputElement;\n    if (inputElement) {\n      inputElement.value = \"\"; // Clear the input value\n    }\n  };\n  var userDeatils = JSON.parse(sessionStorage.getItem(\"userDetails\"));\n\n  return (\n    <div className=\"upload-container \">\n      <div className=\"content\">\n        <SubHeader\n          pageHeadding={`File Upload ${userDeatils.entity}`}\n          showBreadcrumbs={true}\n        />\n        <div className=\"upload-area\">\n          <DropDown\n            mainList={typeOfDropdown}\n            name=\"\"\n            onChangeDropDownItem={handleOptionChange}\n            isMulti={false}\n            classname=\"flex\"\n            placeholder={\"Select an option\"}\n            value={selectedOption}\n          />\n          <div className=\"file-browser\">\n            <label htmlFor=\"file\">Select a file:</label>\n            <input\n              type=\"file\"\n              id=\"file\"\n              onChange={handleFileChange}\n              accept=\".xls, .xlsx\"\n            />\n          </div>\n          <button\n            className=\"filter-button std unwanted text upload-button\"\n            onClick={handleSubmit}\n          >\n            Upload\n          </button>\n          {/* <div className=\"response-text\">{responseText}</div> */}\n        </div>\n        <ErrorComponent />\n      </div>\n      <DownloadExcel />\n    </div>\n  );\n};\n\nexport default FileUpload;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _regeneratorRuntime from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import\"./Login.css\";import{getHttp,postHttp}from\"../../service/APIRequest\";import{useHistory}from\"react-router-dom\";import ErrorComponent from\"../../components/errorComponent/ErrorComponent\";import{getUserApi,loginApi}from\"../../service/Config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"admin\"),_useState6=_slicedToArray(_useState5,2),userType=_useState6[0],setUserType=_useState6[1];// Default value\nvar _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),selectedEntity=_useState8[0],setSelectedEntity=_useState8[1];// Default value\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),entityList=_useState10[0],setEntityList=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),errorMessage=_useState12[0],setErrorMessage=_useState12[1];var _useState13=useState(\"main_admin\"),_useState14=_slicedToArray(_useState13,2),adminType=_useState14[0],setAdminType=_useState14[1];var textBoxRef=useRef(null);useEffect(function(){// getEntityList();\nif(textBoxRef.current){textBoxRef.current.focus();}},[]);var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(!username||!password)){_context.next=3;break;}// Display an error message for empty fields\nsetErrorMessage(\"Username and password are required.\");return _context.abrupt(\"return\");case 3:// if (userType === \"admin\" && !adminType) {\n//   // Display an error message for admin type dropdown\n//   setErrorMessage(\"Please select an admin type.\");\n//   return;\n// }\n// if (userType === \"user\" && !selectedEntity) {\n//   // Display an error message for entity dropdown\n//   setErrorMessage(\"Please select an entity.\");\n//   return;\n// }\n// Reset error message if there are no validation errors\nsetErrorMessage(\"\");_context.prev=4;_context.next=7;return postHttp(loginApi,{username:username,password:password// userType: userType == \"admin\" ? adminType : userType,\n// userType:\n//   userType == \"admin\"\n//     ? \"main_admin\"\n//     : userType == \"desc_user\"\n//     ? \"desc_user\"\n//     : userType,\n// entity: selectedEntity,\n});case 7:response=_context.sent;//console.log(response);\n//if (response.status == 200) {\n// Store token in session storage\n// Redirect to a protected page\nif(response){console.log(response);if(response.status>=200&&response.status<300){getUserDetails(username);// sessionStorage.setItem(\"userDetails\", JSON.stringify(response.data));\n// sessionStorage.setItem(\"loginStatus\", \"true\");\n// history.push(\"/\", response.data);\n}else{console.log(\"-------\");}}// }\n_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](4);console.error(\"Login failed\",_context.t0);setErrorMessage(_context.t0);case 15:case\"end\":return _context.stop();}},_callee,null,[[4,11]]);}));return function handleLogin(){return _ref.apply(this,arguments);};}();var getUserDetails=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(user){var userResponse;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getHttp(getUserApi+user);case 2:userResponse=_context2.sent;if(userResponse){console.log(userResponse);sessionStorage.setItem(\"userDetails\",JSON.stringify(userResponse.data));sessionStorage.setItem(\"loginStatus\",\"true\");history.push(\"/\",userResponse.data);}case 4:case\"end\":return _context2.stop();}},_callee2);}));return function getUserDetails(_x){return _ref2.apply(this,arguments);};}();// const handleUserTypeChange = (event) => {\n//   setUserType(event.target.value);\n//   if (event.target.value == \"user\") {\n//     getEntityList();\n//   }\n// };\nvar handleEntityChange=function handleEntityChange(event){setSelectedEntity(event.target.value);//console.log(selectedValue);\n//setSelectedEntity(selectedValue.label);\n};// const getEntityList = async () => {\n//   const response = await getHttp(\"entity/getNameDetails\"); //\n//   await setEntityList(response);\n// };\nvar handleAdminTypeChange=function handleAdminTypeChange(event){setAdminType(event.target.value);//setSelectedEntity(selectedValue.label);\n};return/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",value:username,onChange:function onChange(e){return setUsername(e.target.value);},className:\"button\",ref:textBoxRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},className:\"button\"})]}),userType===\"user\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"display-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"align-center\",children:\"Entity\"}),/*#__PURE__*/_jsx(\"select\",{value:selectedEntity,onChange:handleEntityChange,className:\"new-user button\",children:entityList===null||entityList===void 0?void 0:entityList.map(function(item,index){return/*#__PURE__*/_jsx(\"option\",{value:item.name,children:item.label},index);})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"login-button\",onClick:handleLogin,children:\"Login\"}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:errorMessage}),/*#__PURE__*/_jsx(ErrorComponent,{})]})})// <UserLogin />\n;}export default Login;","map":{"version":3,"names":["React","useEffect","useRef","useState","getHttp","postHttp","useHistory","ErrorComponent","getUserApi","loginApi","Login","history","username","setUsername","password","setPassword","userType","setUserType","selectedEntity","setSelectedEntity","entityList","setEntityList","errorMessage","setErrorMessage","adminType","setAdminType","textBoxRef","current","focus","handleLogin","response","console","log","status","getUserDetails","error","user","userResponse","sessionStorage","setItem","JSON","stringify","data","push","handleEntityChange","event","target","value","handleAdminTypeChange","e","map","item","index","name","label"],"sources":["/Users/eanas.v/Desktop/DESC-Projects/2023/DB-managmnt-app/dashboard/src/pages/login/Login.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport axios from \"axios\";\n\nimport \"./Login.css\";\nimport { getHttp, postHttp } from \"../../service/APIRequest\";\nimport { useHistory } from \"react-router-dom\";\nimport ErrorComponent from \"../../components/errorComponent/ErrorComponent\";\nimport { getUserApi, loginApi } from \"../../service/Config\";\n\nfunction Login() {\n  const history = useHistory();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [userType, setUserType] = useState(\"admin\"); // Default value\n  const [selectedEntity, setSelectedEntity] = useState(\"\"); // Default value\n  const [entityList, setEntityList] = useState<any>();\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [adminType, setAdminType] = useState(\"main_admin\");\n\n  const textBoxRef = useRef(null);\n\n  useEffect(() => {\n    // getEntityList();\n    if (textBoxRef.current) {\n      textBoxRef.current.focus();\n    }\n  }, []);\n\n  const handleLogin = async () => {\n    if (!username || !password) {\n      // Display an error message for empty fields\n      setErrorMessage(\"Username and password are required.\");\n      return;\n    }\n\n    // if (userType === \"admin\" && !adminType) {\n    //   // Display an error message for admin type dropdown\n    //   setErrorMessage(\"Please select an admin type.\");\n    //   return;\n    // }\n\n    // if (userType === \"user\" && !selectedEntity) {\n    //   // Display an error message for entity dropdown\n    //   setErrorMessage(\"Please select an entity.\");\n    //   return;\n    // }\n\n    // Reset error message if there are no validation errors\n    setErrorMessage(\"\");\n    try {\n      const response = await postHttp(loginApi, {\n        username,\n        password,\n        // userType: userType == \"admin\" ? adminType : userType,\n        // userType:\n        //   userType == \"admin\"\n        //     ? \"main_admin\"\n        //     : userType == \"desc_user\"\n        //     ? \"desc_user\"\n        //     : userType,\n        // entity: selectedEntity,\n      });\n      //console.log(response);\n      //if (response.status == 200) {\n      // Store token in session storage\n\n      // Redirect to a protected page\n      if (response) {\n        console.log(response);\n        if (response.status >= 200 && response.status < 300) {\n          getUserDetails(username);\n          // sessionStorage.setItem(\"userDetails\", JSON.stringify(response.data));\n          // sessionStorage.setItem(\"loginStatus\", \"true\");\n          // history.push(\"/\", response.data);\n        } else {\n          console.log(\"-------\");\n        }\n      }\n      // }\n    } catch (error) {\n      console.error(\"Login failed\", error);\n      setErrorMessage(error);\n    }\n  };\n\n  const getUserDetails = async (user) => {\n    const userResponse = await getHttp(getUserApi + user);\n    if (userResponse) {\n      console.log(userResponse);\n      sessionStorage.setItem(\"userDetails\", JSON.stringify(userResponse.data));\n      sessionStorage.setItem(\"loginStatus\", \"true\");\n      history.push(\"/\", userResponse.data);\n    }\n  };\n\n  // const handleUserTypeChange = (event) => {\n  //   setUserType(event.target.value);\n  //   if (event.target.value == \"user\") {\n  //     getEntityList();\n  //   }\n  // };\n\n  const handleEntityChange = (event) => {\n    setSelectedEntity(event.target.value);\n    //console.log(selectedValue);\n    //setSelectedEntity(selectedValue.label);\n  };\n\n  // const getEntityList = async () => {\n  //   const response = await getHttp(\"entity/getNameDetails\"); //\n  //   await setEntityList(response);\n  // };\n\n  const handleAdminTypeChange = (event) => {\n    setAdminType(event.target.value);\n    //setSelectedEntity(selectedValue.label);\n  };\n\n  return (\n    <div className=\"login-container\">\n      <div className=\"login-form\">\n        <div className=\"display-flex\">\n          <div className=\"align-center\">Username</div>\n          <input\n            type=\"text\"\n            placeholder=\"Username\"\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n            className=\"button\"\n            ref={textBoxRef}\n          />\n        </div>\n        <div className=\"display-flex\">\n          <div className=\"align-center\">Password</div>\n          <input\n            type=\"password\"\n            placeholder=\"Password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            className=\"button\"\n          />\n        </div>\n\n        {/* <div className=\"display-flex\">\n          <div className=\"align-center\">User Type</div>\n\n          \n          <select\n            value={userType}\n            onChange={handleUserTypeChange}\n            className=\"new-user button\"\n          >\n            {userTypes.map((item, index) => (\n              <option key={index} value={item.label}>\n                {item.name}\n              </option>\n            ))}\n          </select>\n        </div> */}\n        {/* {userType === \"admin\" && (\n          <div className=\"display-flex\">\n            <div className=\"align-center\">Admin Type</div>\n            <select value={adminType} onChange={handleAdminTypeChange}>\n              <option value=\"main_admin\">Main Admin</option>\n              <option value=\"desc_admin\">Desc Admin</option>\n            </select>\n          </div>\n        )} */}\n\n        {userType === \"user\" && (\n          <div className=\"display-flex\">\n            <div className=\"align-center\">Entity</div>\n            <select\n              value={selectedEntity}\n              onChange={handleEntityChange}\n              className=\"new-user button\"\n            >\n              {entityList?.map((item, index) => (\n                <option key={index} value={item.name}>\n                  {item.label}\n                </option>\n              ))}\n            </select>\n            {/* <DropDown\n              mainList={entityList}\n              //name=\"Filter\"\n              onChangeDropDownItem={handleEntityChange}\n              isMulti={false}\n            /> */}\n          </div>\n        )}\n\n        <button className=\"login-button\" onClick={handleLogin}>\n          Login\n        </button>\n        {errorMessage && <div className=\"error-message\">{errorMessage}</div>}\n        <ErrorComponent />\n      </div>\n    </div>\n    // <UserLogin />\n  );\n}\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}